---
title: "Peer Assessment 02"
author: "Luis Urbina"
date: "Wednesday, May 20, 2015"
output: html_document
---
## I    SYNOPSIS
.

## II   DATA PROCESSING 
.

### Loading and exploring the data
.

#### 2.1) Loading the data
Given the data file 'repdata-data-StormData.csv.bz2', the data is 
loaded using the `read.csv()` function. The dataset is named **data**.

```{r, echo=TRUE, cache=TRUE}
    data = read.csv(bzfile('repdata-data-StormData.csv.bz2'))    
```
.

#### 2.2) Exploring the dataset behavior.

```{r, echo=TRUE, cache=TRUE}
    str(data)
```

The `str()` function give as a big picture of the dataset such as the 
variables name, total number of observation (902297 observations), and 
the total number of variables (37). It also indicates the varible type
of each variable and visualize that the **REFNUM** is a unique value 
variable type and may be used as index.

.

### Events with Population Health Harm 
.

#### 2.3) Analisis of variables: Fatalities and Injuries
According to the document, the variables **FATALITIES** and **INJURIES** 
are directly related with the populationn health harm caused for the storm
events. A brief analysis of these variables is next.

```{r, echo=TRUE, cache=TRUE}
    summary(data[,c(23,24)])
```

For the nature of the events, natural phenomenum, the nature of the 
distribution of these variables may be considered discrete. With a 
median equal to zero and a mean very far away of the maximum 
value of the serie, for both variables, a lecture over the summary 
indicates that both variables have a kind of chi distribution behavior. 

The **fatalities ratio** and the **injuries ratio** are indicators of 
the impact of the maximum number of fatalities and injuries caused for 
the biggest event over the total of fatalities and injuries caused for 
the total number of events. 

```{r, echo=TRUE, cache=TRUE}
    max(data$FATALITIES) * 100 / sum(data$FATALITIES)
```

```{r, echo=TRUE, cache=TRUE}
    max(data$INJURIES) * 100 / sum(data$INJURIES)
```

Considering tha the storm event database has registred 902,297 events,
the mean of the variables, (0.0168 and 0.1557 for fatalities and injuries
respectively), and the fatalities and injuries ratio, calculated above, 
also indicates a large number of events of low impact and few events
of big impacts.

So this research will conduct to determine the events with the biggest
people health harm.  

The **histogram of fatalaties** in an event.
```{r, echo=TRUE, cache=TRUE}
    hist(unique(data$FATALITIES), breaks=25, col='red')
```

The **histogram of INJURIES** in an event.

```{r, echo=TRUE, cache=TRUE}
    hist(unique(data$INJURIES), breaks=25, col='green')
```

.

#### 2.4) Identification of events with big impact 

```{r, echo=TRUE, cache=TRUE}
    data.fat.inj <- rbind(data[(data$FATALITIES > 500),] , data[(data$INJURIES > 500),])
    data.fat.inj$TOTAL <- data.fat.inj$FATALITIES + data.fat.inj$INJURIES
    top.fat.inj <- data.fat.inj[order(-data.fat.inj$TOTAL),]
    
    #top.fat.inj[(top.fat.inj$TOTAL > 1000),c(2,7,8,23,24,38)]
    
    head(top.fat.inj[,c(2,7,8,23,24,38)], n=8, row.names=FALSE)
```

.

#### Events with Greatest Economic Consecuences

## III  RESULTS
#### 1)
#### 2)
#### 3)
#### 1.3) Imputing missing values

The **Total Number of Missing Values**
```{r, echo=TRUE, cache=TRUE}
    tidy.NA <- data[,c(1,2,8,22,23)]
    na.identifier <- apply(tidy.NA, 1, function(x){any(is.na(x))})
    total.NA <- sum(na.identifier)
    total.NA
```
